# 實作備註品質指引

本文件提供實作備註的撰寫指引和品質檢查清單，確保記錄的一致性和實用性。

## 品質檢查清單

為確保實作備註的品質和一致性，請遵循以下檢查清單：

| 情況 | 良好範例 | 避免範例 |
|------|-----------|-----------|
| 按預期完成 | 「照預期開發」 | 列出所有實作細節（這些應該在任務敘述中） |
| 方向調整 | `[方向調整] 原用 X 但因 Y 不可行改用 Z，驗證後確認可行` | `改用了另一個方法` |
| 技術障礙 | `[技術障礙] X 限制導致 Y 問題，使用 Z 繞過，測試通過` | `遇到一些問題但解決了` |
| 關鍵決策 | `[技術決策] 比較 X 和 Y，選擇 Y 因 Z 考量，權衡是 W` | `決定用 Y` |
| 後續依賴 | `[後續依賴] 新增全域 config，後續任務需引入此檔案` | `做了一些修改` |

## 記錄原則

### 需要記錄的情況

- 原任務敘述中提到的方法行不通，改用其他方法
- 發現設計錯誤，需要修改先前的實作
- 遇到預期外的技術限制（如 API 不支援、效能問題）
- 與使用者討論超過 3 輪才確定的技術方案
- 需要告知後續任務的重要資訊（如「必須先完成 X 才能做 Y」）

### 不需記錄的情況

- 按照任務敘述直接實作完成
- 正常的除錯過程（如修正小的語法錯誤、typo）
- 任務敘述中已經提到的實作細節
- 常規的技術選擇（如選擇已知的資料結構、設計模式）

## 標籤使用說明

### [方向調整]

**觸發條件**：使用者指出錯誤、發現技術限制、原方法行不通

**記錄格式**：`[方向調整] 原計畫 X 因 Y 原因不可行，改用 Z 方法`

**範例**：
- `[方向調整] 原計畫使用 localStorage 但需跨 tab 同步，改用 BroadcastChannel API`
- `[方向調整] 原用 REST API 但後端尚未實作，暫時使用 mock data`

### [技術障礙]

**觸發條件**：API 不支援、效能瓶頸、相容性問題、需要繞過的限制

**記錄格式**：`[技術障礙] 遇到 X 問題，因為 Y，解決方式是 Z`

**範例**：
- `[技術障礙] Next.js 動態路由不支援 SSG，需使用 generateStaticParams 預生成路徑`
- `[技術障礙] Safari 不支援 ResizeObserver，新增 polyfill 解決`

### [技術決策]

**觸發條件**：有多個可行方案、需要權衡取捨、影響後續任務

**記錄格式**：`[技術決策] 在 X 和 Y 方案之間選擇 Z，因為 W`

**範例**：
- `[技術決策] 在 REST 和 GraphQL 之間選擇 REST，因現有後端已是 REST 且團隊更熟悉`
- `[技術決策] 選擇使用 zustand 而非 redux，因狀態較簡單且 zustand 更輕量`

### [後續依賴]

**觸發條件**：建立了新的前置條件、修改了共享資源、有執行順序要求

**記錄格式**：`[後續依賴] 後續任務需注意 X，因為 Y`

**範例**：
- `[後續依賴] 後續任務需注意必須先呼叫 initAuth() 才能使用其他 auth 函數`
- `[後續依賴] 新增了 UserContext，後續 UI 任務需要包在 UserProvider 內`

## 核心價值

實作備註的核心目的是**跨對話傳遞脈絡**：

1. **記憶延續**：AI 在新對話中能理解前置任務的關鍵決策
2. **避免重複錯誤**：記錄失敗的嘗試，避免後續走同樣彎路
3. **依賴追蹤**：明確記錄任務之間的依賴關係
4. **決策透明**：讓團隊成員理解「為什麼」這樣實作

# 研究與分析

## 目標

進行深入的研究和分析，了解專案背景、識別根本問題，並提供全面的洞察來支援決策制定。研究結果將儲存在 `docs/research/` 目錄，並可能引導後續的 PRD 建立和實作。

## 流程

1. **接收初始請求：** 使用者提供問題描述、功能需求或需要調查的技術問題。
2. **初步專案了解：** 快速檢視關鍵專案檔案（最多 3-5 個檔案）以了解基本架構和技術堆疊。
3. **提出釐清問題：** 根據初始請求，提出 3-5 個針對性問題以更好地理解問題。
4. **深度分析：** 收到回答後，進行全面的程式碼庫檢查和問題調查。
5. **外部研究：** 進行針對性的網路搜尋，尋找最佳實踐、解決方案和相關資訊。
6. **產生研究文件：** 建立包含發現和建議的完整研究文件。
7. **取得當前日期：** 取得日期： `date +%Y-%m-%d`
8. **儲存研究：** 將文件儲存為 `docs/research/[date]-[topic-slug].md`。
9. **後續步驟：** 根據研究發現，建議是否：
   - 建立一個或多個 PRD 進行實作
   - 直接進行實作
   - 在特定領域進行額外研究

## 釐清問題框架

提出有助於發現真正問題並釐清意圖的問題。根據情境調整：

### 功能需求類：

- **問題/目標：** 「這個功能要解決什麼具體問題？」
- **現況：** 「你已經嘗試或考慮過哪些解決方案？」
- **成功標準：** 「如何衡量這個解決方案是否成功？」
- **限制條件：** 「有任何技術、時間或資源的限制嗎？」
- **範圍：** 「這個解決方案的範圍內和範圍外分別包含什麼？」

### 技術問題類：

- **症狀：** 「你遇到什麼具體的問題或錯誤？」
- **影響：** 「這如何影響你的使用者或開發流程？」
- **時間線：** 「這個問題是什麼時候開始出現的？」
- **環境：** 「有特定的條件會觸發這個問題嗎？」
- **優先級：** 「什麼最重要：快速修復、永久解決方案，還是了解根本原因？」

### 架構決策類：

- **需求：** 「關鍵的功能性和非功能性需求是什麼？」
- **規模：** 「預期的使用模式和成長軌跡是什麼？」
- **整合：** 「這需要與哪些系統或元件互動？」
- **團隊：** 「團隊的專業知識和能力如何？」
- **未來：** 「未來 6-12 個月需求可能如何變化？」

## 研究文件結構與撰寫指導

產生的研究文件應具備良好的敘述流暢性，避免過度依賴條列式結構。採用清晰、簡潔的說明方式。以下是建議的文件結構：

### 1. 執行摘要

**撰寫原則：** 採用敘述性方式開始，簡潔地說明研究背景和目的。之後可用 2-3 個重點條列關鍵發現，但每個要點都應包含簡短說明其重要性。

**範例開頭：**
"本研究針對 [具體問題] 進行深入分析，旨在為團隊提供清晰的技術方向。經過全面調查後，我們發現了幾個關鍵議題需要優先處理..."

### 2. 背景與脈絡

**撰寫原則：** 用敘述方式建立清楚的背景脈絡，幫助讀者理解問題的來龍去脈。先用段落說明專案特性和現況，再解釋問題的重要性。

**建議結構：**
- 從專案的整體目標開始說明
- 描述當前的技術架構和運作方式
- 自然地帶出遇到的問題或需要改善的地方
- 解釋這些問題對團隊或使用者的影響

### 3. 研究問題與發現過程

**撰寫原則：** 清楚說明研究問題的演進過程，讓讀者了解思考脈絡。將使用者的初始請求、釐清問題的過程，以及最終問題定義有邏輯地串連起來。

### 4. 技術分析：深入理解問題

**撰寫原則：** 建立清楚的技術分析脈絡，從現況分析開始，逐步深入到問題核心，最後連結到外部知識。前面用敘述建立脈絡後，可以較多使用條列來整理技術細節。

#### 4.1 程式碼庫現況探索

以敘述方式描述專案的技術現況，解釋當前的架構選擇背後的邏輯。例如：
"經過程式碼審查，我們發現專案採用了 [架構模式]，這個選擇在 [某個時期] 是合理的，因為... 然而，隨著需求的演進，這個架構開始出現 [具體問題]。"

接著用簡潔的條列補充技術細節：
- 核心架構模式及其適用性
- 關鍵依賴和它們的版本狀況
- 效能瓶頸和擴展性限制

#### 4.2 問題根源追蹤

先用段落說明分析過程和發現的關鍵問題，例如：
"初步觀察顯示問題出現在 [表面現象]，進一步調查後發現真正原因是 [根本原因]..."

接著可用條列整理：
- 問題表面現象和深層原因
- 相關的技術限制和依賴
- 影響範圍和風險評估

#### 4.3 業界智慧與最佳實踐

簡要說明外部研究的發現和相關性：
"調研發現 [公司/專案] 的類似解決方案是 [方案說明]，其核心原理是 [原理]，適合我們是因為 [適用性]..."

主要發現可用條列整理：
- 業界最佳實踐和核心原理
- 類似案例和解決方案
- 相關工具和技術選擇

### 5. 解決方案探索與評估

**撰寫原則：** 先用段落建立各方案的脈絡和比較基礎，然後可用條列整理具體評估。

為每個方案先用一段說明：
- 方案的核心理念和適用性
- 在我們專案環境中的考量因素

然後用條列總結評估：
- **實作複雜度：** [評估] - [具體原因]
- **維護影響：** [評估] - [長期考量]  
- **風險等級：** [評估] - [主要風險點]

### 6. 建議與決策指引

**撰寫原則：** 先用段落說明推薦決策的邏輯和考量，然後用條列整理實施指引。

推薦邏輯說明：
"基於分析結果，建議採用 [方案名稱]。主要考量包括：[關鍵考量]，相比其他方案更適合我們的情況是因為 [具體原因]。"

實施指引：
- **立即行動：** [具體步驟]
- **中期規劃：** [關鍵里程碑]
- **風險監控：** [注意事項]

### 7. 下一步行動計畫

**撰寫原則：** 提供清晰的行動指引，說明實施的邏輯順序。

簡潔說明後續步驟的邏輯：
"實施需要分階段進行。第一階段重點是 [目標]，第二階段則是 [目標]..."

具體步驟：
- **立即行動：** [具體可執行的任務]
- **中期目標：** [下一個關鍵步驟]
- **PRD 需求：** 如果需要撰寫 PRD，說明原因和範圍
- **額外調研：** 需要進一步了解的部分

### 8. 參考資料

**撰寫原則：** 提供有價值的資源，簡要說明其用途。

分類整理：
- **技術文件：** [直接相關的技術資源]
- **實作範例：** [程式碼範例和最佳實踐]
- **延伸閱讀：** [深入主題的資源]

## 與 PRD 和實作的整合

完成研究後：

1. **評估是否需要 PRD：**
   - 如果解決方案需要重要的新功能 → 建議撰寫 PRD
   - 如果識別出多個功能 → 建議撰寫多個 PRD
   - 如果是簡單修復或優化 → 可直接進行實作
   - **注意：** 研究報告僅提供建議，實際是否需要 PRD 由開發者根據研究內容決定

2. **PRD 撰寫參考（如開發者決定撰寫）：**
   - 在 PRD 中「引用」研究文件和研究發現，而非「複製」技術細節
   - 使用研究發現來制定需求
   - 將特定研究章節連結到 PRD 章節

   **引用 vs 複製的原則：**
   - ✅ **好的引用範例：** 「基於 research 文件的分析，建議採用事件驅動架構」
   - ❌ **避免的複製範例：** 直接複製 research 中的程式碼範例、架構圖、詳細技術分析到 PRD
   - **原因：** PRD 的讀者是產品經理和業務人員，技術細節會在 implementation.md 階段被保留和引用
   - **機制：** `/create-impl-plan` 會自動從 research 文件中提取技術細節到 implementation.md 的「實作參考資訊」章節

3. **實作規劃：**
   - 使用研究來建立詳細的實作任務
   - 參考研究進行技術決策
   - 如果有新發現，保持研究更新

## 語言選擇

研究文件應使用與使用者對話相同的語言撰寫：

- 如果使用者用中文溝通，用繁體中文撰寫文件
- 如果使用者用英文溝通，用英文撰寫文件
- 在整個文件中保持一致性

## 撰寫風格與品質指引

### 脈絡建立與內容組織

**開頭脈絡優先：** 每個主要章節都要先用敘述性內容建立清楚的脈絡和背景，幫助讀者理解。脈絡建立後，可以較多使用條列來組織具體資訊。

**前期敘述，後期條列：**
- **執行摘要、背景脈絡：** 以敘述為主，建立理解基礎
- **技術分析、解決方案：** 開頭敘述脈絡，然後可用條列整理細節
- **行動計畫、參考資料：** 可以條列為主

**敘述重點：**
- 建立問題背景和重要性
- 解釋分析過程和邏輯
- 說明決策推理

**條列重點：**
- 技術規格和具體參數
- 比較表格和評估總結
- 行動步驟和資源清單

### 品質檢核要點

- **脈絡清晰：** 開頭必須建立清楚的背景脈絡
- **邏輯順序：** 內容組織符合邏輯順序
- **簡潔實用：** 聚焦關鍵資訊，指向具體行動
- **結構平衡：** 適當平衡敘述與條列的使用

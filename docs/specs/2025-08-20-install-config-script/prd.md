# 配置安裝腳本 PRD

## 簡介/概述

本功能旨在提供一個自動化的 npm 腳本，用於將 claude-code-config 專案中的指令文件安裝到使用者的 Claude Code 配置目錄中。透過 shelljs 函式庫實現跨平台相容性，讓使用者能夠輕鬆地在 Windows、macOS 和 Linux 系統上安裝這些工作流程指令，從而在自己的 Claude Code 環境中使用這套標準化的開發流程。

## 目標

1. 提供一鍵式安裝體驗，讓使用者執行 `npm run install-config` 即可完成配置
2. 支援 Windows、macOS 和 Linux 三大作業系統
3. 智慧處理檔案覆蓋情況，避免意外覆蓋使用者的自訂設定
4. 確保安裝過程的錯誤處理和使用者回饋

## 使用者故事

**故事 1：首次安裝使用者**
作為一個首次使用 claude-code-config 的開發者，我想要透過簡單的 npm 指令來安裝所有的工作流程指令，以便我能在 Claude Code 中使用這些標準化的開發流程。

**故事 2：更新配置的使用者**
作為一個已經安裝過配置的使用者，當我執行安裝腳本時，我希望系統能詢問我是否要覆蓋現有的檔案，以便我能保護自己的自訂修改。

**故事 3：跨平台開發者**
作為一個在不同作業系統間切換的開發者，我希望同一個安裝指令能在 Windows、macOS 和 Linux 上正常運作，以便我在任何環境都能快速設置。

## 功能需求

1. **腳本配置**
   - 系統必須在 package.json 中提供 `install-config` npm script
   - 系統必須使用 shelljs 作為跨平台檔案操作的函式庫

2. **目標路徑識別**
   - 系統必須自動偵測當前作業系統
   - 系統必須根據作業系統決定正確的安裝路徑：
     - Windows: `C:\Users\[username]\.claude\commands\`
     - macOS: `~/.claude/commands/`
     - Linux: `~/.claude/commands/`

3. **檔案複製**
   - 系統必須將 `commands` 資料夾中的所有 .md 檔案複製到目標路徑
   - 系統必須保持原始檔案結構和命名

4. **覆蓋檢查**
   - 系統必須檢查每個要複製的 .md 檔案是否已存在於目標路徑
   - 如果發現任何要複製的檔案在目標路徑已存在，系統必須詢問使用者是否要覆蓋
   - 使用者選擇覆蓋時，系統必須替換所有衝突的檔案
   - 使用者選擇不覆蓋時，系統必須取消安裝並保留原有檔案

5. **目錄管理**
   - 如果目標目錄不存在，系統必須自動建立完整的目錄結構
   - 系統必須確保建立的目錄具有適當的權限

6. **錯誤處理**
   - 如果沒有寫入權限，系統必須顯示清晰的錯誤訊息
   - 系統必須在任何檔案操作失敗時停止執行並報告錯誤

7. **使用者回饋**
   - 系統必須在安裝成功後顯示確認訊息
   - 系統必須顯示已安裝的檔案數量和安裝路徑

## 非目標（超出範圍）

1. 不提供解除安裝功能（`npm run uninstall-config`）
2. 不提供更新功能來保留使用者的自訂修改
3. 不支援版本管理或版本切換
4. 不顯示檔案差異比較
5. 不複製 commands 資料夾以外的檔案
6. 不執行任何安裝後的初始化步驟
7. 不提供備份機制

## 技術考量

1. **相依套件**
   - 需要安裝 shelljs 套件作為專案相依性
   - 可能需要 inquirer 或類似套件來處理使用者輸入

2. **跨平台相容性**
   - 使用 shelljs 的跨平台 API 而非原生 shell 指令
   - 使用 Node.js 的 `os.homedir()` 來取得使用者主目錄
   - 使用 `path.join()` 來建構跨平台的檔案路徑

3. **權限處理**
   - 在 Unix 系統上可能需要適當的檔案權限
   - Windows 系統可能有不同的權限模型

## 開放問題

1. 是否需要支援自訂安裝路徑（透過環境變數或參數）？
2. 是否需要記錄安裝日誌以便故障排除？
3. 未來是否考慮支援選擇性安裝特定的指令檔案？
4. 是否需要支援 Claude Code 的專案級別配置（`.claude/commands/`）安裝？

## 驗收標準

1. **基本安裝流程**
   - 執行 `npm run install-config` 能成功將所有 .md 檔案複製到正確的系統目錄
   - 在 Windows、macOS 和 Linux 上都能正常運作

2. **覆蓋保護**
   - 當目標目錄已有檔案時，系統會詢問是否覆蓋
   - 使用者選擇「是」時，檔案被成功覆蓋
   - 使用者選擇「否」時，原有檔案保持不變

3. **錯誤處理**
   - 無寫入權限時顯示明確的錯誤訊息
   - 目錄不存在時能自動建立

4. **使用者體驗**
   - 安裝成功後顯示確認訊息
   - 整個過程提供清晰的進度回饋